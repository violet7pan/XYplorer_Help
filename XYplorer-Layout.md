---
title: XYplorer-å¸ƒå±€(Layout)
tags: [XYplorer]
---


# XYå¸ƒå±€å…ƒç´ ä»‹ç»

å¸ƒå±€ç¯‡ä»‹ç»å¸ƒå±€å…ƒç´ çš„ä½¿ç”¨ï¼Œé€šè¿‡ä¸‹é¢ä¸‰å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸‹XYploreræœ‰å“ªäº›å¸ƒå±€å…ƒç´ ï¼š


![XYplorerLayoutElement-1](_resources/XYplorerLayoutElement-1.png)

![XYplorerLayoutElement-2](_resources/XYplorerLayoutElement-2.png)

File Listï¼šæ–‡ä»¶åˆ—è¡¨ï¼Œæœ€å¥½çš„ç§°å‘¼æ˜¯æ–‡ä»¶åˆ—è¡¨è§†çª—ã€‚è¿™é‡Œçš„æ–‡ä»¶æ—¶åŒ…å«æ–‡ä»¶é¡¹ç›®å’Œæ–‡ä»¶å¤¹é¡¹ç›®ã€‚

åœ¨è‡ªå®šä¹‰åŠ¨ä½œäº‹ä»¶(CEA)ä¸­ï¼Œæˆ‘çœ‹åˆ°"Folder List"å‡ºç°è¿‡ï¼Œåœ¨åŠŸèƒ½ä½¿ç”¨ä¸Šï¼Œæˆ‘è®¤ä¸ºå®ƒæŒ‡çš„æ˜¯"File List"(å°±ç›®å‰è€Œè¨€)ã€‚

![XYplorerLayoutElement-3](_resources/XYplorerLayoutElement-3.png)



# å¯¼èˆªé¢æ¿ä¹‹ç›®å½•

## æ‰“å¼€å¯¼èˆªé¢æ¿-ç›®å½•

F8->Ctrl+F8å³å¯æ‰“å¼€ã€‚

![Catalog-1](_resources/Catalog-1.png)



## æ·»åŠ ç›®å½•

Catalogæ æ˜¯ç©ºç™½çš„ï¼Œéœ€è¦å³é”®`Add New Category...`

![Catalog-2](_resources/Catalog-2.png)

è‡ªå®šä¹‰åç§°

![Catalog-3](_resources/Catalog-3.png)

ç¡®è®¤å³è¾¹æ å°±ä¼šå˜æˆè¿™æ ·

![Catalog-4](_resources/Catalog-4.png)



## æ·»åŠ é¡¹ç›®

**æ‹–åŠ¨å¼æ·»åŠ **

å¦‚æœä½ éœ€è¦æ·»åŠ æ–‡ä»¶åˆ°ç›®å½•ä¸Šï¼Œé‚£ä¹ˆå°±æŠŠæ–‡ä»¶æ‹–åˆ°â€œä½ éœ€è¦çš„åç§°â€ä¸Šã€‚

æ¯”å¦‚æˆ‘æŠŠä¸€å¼ å›¾ç‰‡(Catalog-4.png)æ‹–åˆ°ç›®å½•åä¸Šï¼Œå°±ä¼šå‡ºç°å¦‚ä¸‹å†…å®¹ï¼Œ

![Catalog-5](_resources/Catalog-5.png)



**è‡ªå®šä¹‰å¼æ·»åŠ **

è¿™é‡Œä»‹ç»ä¸‰ä¸ªåº”ç”¨å®ä¾‹å¯ä¾›å‚è€ƒï¼š

**æ·»åŠ æ–‡ä»¶/æ–‡ä»¶å¤¹**

é€‰ä¸­ç›®å½•åç§°ï¼Œç„¶åå³é”®`Add New Item Here...`(å¿«æ·é”®å¼<kbd>Insert</kbd>)ï¼Œå¯ä»¥è‡ªå®šä¹‰ä½ è¦æ·»åŠ çš„é¡¹ç›®ã€‚æ¯”å¦‚åˆšåˆšæ·»åŠ çš„.pngæ–‡ä»¶å°±æ˜¯ä¸€ä¸ªé¡¹ç›®(Item)ã€‚

**æ·»åŠ è„šæœ¬**

ä»¥ä¸‹è„šæœ¬çš„åŠŸèƒ½æ˜¯é€‰ä¸­ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åé¼ æ ‡å·¦é”®è½»ç‚¹ä¸€ä¸‹å°±ä¼šå¤åˆ¶æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸è¿‡è¿™ä¸ªæ–‡ä»¶çš„è·¯å¾„æ˜¯ä»¥æ­£æ–œæ†`/`åˆ†å‰²è·¯å¾„éƒ¨åˆ†çš„ã€‚æ¯”å¦‚ï¼Œ`D:/Work/GitWorks/XYplorer_Help/Updates/Image/Catalog-5.png`ï¼Œè€Œä¸æ˜¯`D:\Work\GitWorks\XYplorer_Help\Updates\Image\Catalog-5.png`ã€‚è¿™ä¹ˆåšæ˜¯ä¸ºäº†é¿å…è¦åœ¨å­—ç¬¦ä¸²ä¸­è½¬ä¹‰åæ–œæ `\`ã€‚

è„šæœ¬å†…å®¹å¦‚ä¸‹

![Catalog-6](_resources/Catalog-6.png)

Caption: `Copy Path With Forward-slash to Clipboard `

Location:

```
::if(<curitem>==""){copytext replace(<curpath>, "\", "/");} else{copytext replace(<curitem>, "\", "/");}
```

**æ·»åŠ çº¸æ–‡ä»¶å¤¹**

1. è¿›å…¥çº¸æ–‡ä»¶å¤¹å­˜æ”¾ç›®å½•ï¼Œåˆ›å»ºçº¸æ–‡ä»¶å¤¹ã€‚ä»åœ°å€æ è¾“å…¥`<xypaper>`è¿›å…¥çº¸æ–‡ä»¶å¤¹ä¿å­˜ç›®å½• (XYplorer\Data\Paper)ï¼Œåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºæ–‡æœ¬æ–‡ä»¶ä½œä¸ºçº¸æ–‡ä»¶å¤¹ï¼Œ

   æˆ‘åˆ›å»ºçš„åä¸ºTest.txtã€‚

2. æ·»åŠ çº¸æ–‡ä»¶å¤¹åˆ°ç›®å½•ã€‚æ‰“å¼€çº¸æ–‡ä»¶å¤¹çš„è¯­æ³•æ ¼å¼ä¸º`paper:çº¸æ–‡ä»¶å¤¹å`

   ![Catalog-7](_resources/Catalog-7.png)

   ![Catalog-8](_resources/Catalog-8.png)

3. æ·»åŠ é¡¹ç›®åˆ°çº¸æ–‡ä»¶å¤¹

   ![Catalog-9](_resources/Catalog-9.png)

   ![Catalog-10](_resources/Catalog-10.png)

è¯·å°½æƒ…æ¢ç´¢çº¸æ–‡ä»¶å¤¹

å¦‚æœä½ æ‰“å¼€\<xypaper\>/Test.txtï¼Œå¯ä»¥å‘ç°å¤šå¤„ä¸€è¡Œå†…å®¹ï¼š

```
D:\Work\GitWorks\XYplorer_Help\Updates\Image\Catalog-8.png
```

çº¸æ–‡ä»¶å¤¹ä¸ä»…å¯ä»¥ä¿å­˜æ–‡ä»¶ï¼Œè¿˜å¯ä»¥ä¿å­˜æ–‡ä»¶å¤¹ï¼Œçº¸æ–‡ä»¶å¤¹ä¸»è¦ç”¨äºå­˜æ”¾åŒä¸€ä¸ªä¸»é¢˜çš„ç´ æã€‚

## ç›®å½•æ•°æ®çš„ä¿å­˜

**å®šä½å½“å‰ç›®å½•çš„æ•°æ®æ–‡ä»¶**

![Catalog-11](_resources/Catalog-11.png)

**æ•°æ®æ–‡ä»¶ä¿å­˜ä½ç½®**

åœ°å€æ è¾“å…¥<code>\<xycatalogs\></code>å›è½¦å³å¯çœ‹åˆ°ç›®å½•æ•°æ®æ–‡ä»¶ã€‚ä¸¢å¤±æ•°æ®æ–‡ä»¶ï¼Œé‚£ä¹ˆç›®å½•æ å°±æ˜¯ç©ºç™½çš„äº†ï¼Œè¯·ä¿å­˜å¥½ã€‚



# å®šåˆ¶æ–‡ä»¶åˆ—è¡¨

ä»¥ä¸‹å†…å®¹è®²è§£éƒ½æ˜¯åœ¨è§†å›¾æ–¹å¼ä¸ºâ€œè¯¦ç»†â€(Details)çš„æƒ…å†µä¸‹è¿›è¡Œçš„ï¼Œæ“ä½œå¦‚ä¸‹å›¾æ‰€ç¤º:(èœå•æ /å·¥å…·æ è¿›è¡Œè§†å›¾è®¾ç½®ï¼ŒäºŒé€‰ä¸€)

![CustomizeList-View-Details-1](_resources/CustomizeList-View-Details-1.png)

åœ¨èœå•æ ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![CustomizeList-SubMenu-1](_resources/CustomizeList-SubMenu-1.png)

è¿™æ˜¯æˆ‘ä¸ºåˆ—è¡¨è®¾ç½®çš„å‚æ•°ï¼Œå‡ ä¸ªæ‰“é’©çš„é€‰é¡¹éƒ½æ˜¯å¸¸ç”¨çš„ã€‚

`Rename On Slow Double-Click`:æ¨èã€‚åŒå‡»å¯è¿›è¡Œæ–‡ä»¶å‘½åã€‚æ³¨æ„ï¼ŒåŒå‡»æ¯æ¬¡ç‚¹å‡»çš„æ—¶é—´é—´éš”é•¿ä¸€ç‚¹ã€‚

`Highlight Selected Row`ï¼šé€‰é¡¹å‹¾é€‰åï¼Œå…¶èƒŒæ™¯é¢œè‰²ç”±å¦‚ä¸‹å›¾å†³å®šï¼š

è®¾ç½®->Colors and Styles->Colors->Selected Rows

![CustomizeList-SelectedRowsBackground-1](_resources/CustomizeList-SelectedRowsBackground-1.png)

`Full Row Select`:ä¸æ¨èï¼Œé€‰ä¸­ä¸€ä¸ªæ–‡ä»¶åï¼Œé‚£ä¹ˆæ•´è¡Œéƒ½è¢«é€‰æ‹©ï¼Œé¼ æ ‡åœ¨æ•´è¡ŒèŒƒå›´å†…åŒå‡»éƒ½æ˜¯æ‰“å¼€æ–‡ä»¶ã€‚è€Œä½¿ç”¨`Highlight Selected Rows`åï¼Œé«˜äº®èƒŒæ™¯è‰²èŒƒå›´å†…åŒå‡»æ˜¯è¿”å›ä¸Šä¸€çº§è·¯å¾„ã€‚

`Autosize Columns`:æ¨èï¼Œè¯¥é€‰é¡¹å¯ä»¥è®©æ–‡ä»¶åˆ—è¡¨çš„æ‰€æœ‰åˆ—ä¿¡æ¯æ˜¾ç¤ºå®Œæ•´ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªåˆ—éƒ½è¿›è¡Œæœ€å¤§æœ‰æ•ˆèŒƒå›´çš„æ‹‰ä¼¸ã€‚

`Show Folder Size`:ä¸æ¨èã€‚å› ä¸ºå¼€å¯åæ¯æ¬¡æµè§ˆéœ€è¦è¯»å–æ–‡ä»¶å¤¹å¤§å°ã€‚å¦‚æœæ–‡ä»¶å¤¹å¤§å°è¿‡å¤§ï¼Œä¼šè®©åŠ è½½é€Ÿåº¦å˜æ…¢ã€‚

åŠ è½½é€Ÿåº¦æœ‰æ•ˆæ”¹å–„çš„æ–¹æ³•ï¼š

è®¾ç½®->Tree and List->List->Cache folder sizes

![CustomizeList-ShowFolderSizes-CacheFolderSizes-1](_resources/CustomizeList-ShowFolderSizes-CacheFolderSizes-1.png)

è¯¥é€‰é¡¹å¯ä»¥åŠ å¿«æµè§ˆæ–‡ä»¶åˆ—è¡¨çš„é€Ÿåº¦ï¼Œä½†æ˜¯æ— æ³•ä¿è¯ç¬¬ä¸€æ¬¡è®¡ç®—çš„æ–‡ä»¶å¤¹å¤§å°çš„å‡†ç¡®æ€§ã€‚å†æ¬¡è®¡ç®—æ–‡ä»¶å¤¹å¤§å°å¯ä¿è¯ç›®æ ‡æ–‡ä»¶å¤¹çš„æœ‰æ•ˆæ€§ï¼Œæ“ä½œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![CustomizeList-ShowFolderSizes-CalculateFolderSizes-1](_resources/CustomizeList-ShowFolderSizes-CalculateFolderSizes-1.png)

å…³äº`Cache folder sizes`çš„ä½œç”¨è¯¦ç»†è¯´æ˜ï¼Œè¯·åœ¨åœ°å€æ è¾“å…¥ï¼š

```
rtfm "idh_settings.htm#idh_foldersizecaching";
```



# æ–‡ä»¶åˆ—è¡¨

## åŸºæœ¬æœ¯è¯­

![CustomizeList](_resources/CustomizeList.png)

XYç•Œé¢çš„å¸ƒå±€ï¼ˆLayoutï¼‰ï¼šå„ç§ç»„ä»¶çš„ä½ç½®æ‘†æ”¾ä»¥åŠæ˜¯å¦æ‘†æ”¾ã€‚ç»„ä»¶æœ‰çŠ¶æ€æ ï¼Œæ ‘ï¼Œç›®å½•ï¼Œè‡ªå®šä¹‰åˆ—ç­‰ç­‰ã€‚

æ–‡ä»¶åˆ—è¡¨ï¼ˆCustomize Listï¼‰ï¼šä½¿ç”¨XYè¿›å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹ä¸‹ä¼šæ˜¾ç¤ºè®¸å¤šæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶ä¸ºä¸€ä¸ªåˆ—è¡¨ï¼Œä¼šæ˜¾ç¤ºåˆ—è¡¨çš„å„ä¸ªå±æ€§ã€‚Customize Listç¿»è¯‘ä¸ºæ–‡ä»¶åˆ—è¡¨æˆ–è€…è‡ªå®šä¹‰åˆ—è¡¨éƒ½å¯ä»¥ï¼Œå¦‚æœæ‰“å¼€ä¸€ä¸ªæ–‡ä»¶å¤¹Aï¼ŒAä¸­ä¸‹é¢æ‰€æœ‰é¡¹ç›®ä¸ºæ–‡ä»¶å¤¹ï¼Œé‚£ä¹ˆCustomize Listå¯ä»¥ç¿»è¯‘ä¸ºæ–‡ä»¶å¤¹åˆ—è¡¨ã€‚

åˆ—å¸ƒå±€ï¼ˆColumn Layoutï¼‰ï¼šå¦‚å›¾æ‰€ç¤ºï¼Œæ¯ä¸ªåˆ—çš„æ‘†æ”¾é¡ºåºä»¥åŠé€‰æ‹©ä»€ä¹ˆç±»å‹çš„åˆ—åœ¨è¿™é‡Œæ˜¾ç¤ºã€‚æ¯ä¸ªæ–‡ä»¶å¤¹ä¸­çš„é¡¹ç›®éƒ½æœ‰è‡ªå·±çš„åˆ—ï¼Œè¿™ä¸ªåˆ—è¡¨å–å†³äºä½ å¦‚ä½•è®¾ç½®åˆ—å¸ƒå±€çš„å‚æ•°ã€‚

é¡¹ç›®ï¼ˆitemï¼‰ï¼šæ¯ä¸ªæ–‡ä»¶éƒ½å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªé¡¹ç›®ã€‚

åˆ—ï¼ˆColumnï¼‰ï¼šå¦‚å›¾æ‰€ç¤ºï¼ŒNameï¼ŒModifiedï¼ŒExtï¼ŒSizeç­‰ç­‰å±æ€§ç»Ÿç§°ä¸ºåˆ—ã€‚åˆ—æ˜¯ä¸€ä¸ªç»Ÿç§°ï¼Œå¯¹åˆ—è¿›è¡Œç»†åˆ†æ—¶ï¼Œå¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š

![Column-Term-1](_resources/Column-Term-1.png)

æ™®é€šåˆ—ï¼ˆColumnï¼‰ï¼šæ™®é€šåˆ—å±äºXYå†…ç½®çš„ï¼Œä¸å¯æ›´æ”¹ï¼Œç”±XYä¸­çš„APIè‡ªåŠ¨è·å–çš„æ–‡ä»¶å±æ€§ä¿¡æ¯ã€‚

è‡ªå®šä¹‰åˆ—ï¼ˆCustom Columnï¼‰ï¼šå¯ç”±ç”¨æˆ·è‡ªè¡Œé€‰æ‹©è¦æ˜¾ç¤ºçš„å±æ€§ï¼Œæˆ–è€…é€šè¿‡ç¼–å†™Scriptæ¥è¾¾åˆ°åŠ¨æ€è·å–æ–‡ä»¶å±æ€§ä¿¡æ¯ã€‚

é¢å¤–åˆ—ï¼ˆExtra Columnï¼‰ï¼šè¿™ç§åˆ—ç”±XYä¿ç•™çš„ï¼Œåœ¨å¸®åŠ©æ‰‹å†Œä¸­æœ‰æåˆ°XYä¿ç•™äº†16ä¸ªé¢å¤–æ ‡ç­¾ï¼ˆExtra Tagsï¼‰ï¼Œè¿™äº›æ ‡ç­¾ä½œä¸ºåˆ—è¿›è¡Œæ˜¾ç¤ºæ—¶æ‰ç§°ä¸ºé¢å¤–åˆ—ã€‚ç”±äºè¿™ç§é¢å¤–åˆ—æ”¯æŒScriptingï¼Œè„šæœ¬é€šè¿‡è·å–åŠ¨æ€è·å–æ–‡ä»¶å±æ€§åï¼Œç»è¿‡å¤„ç†åï¼Œå°†è¾“å‡ºç»“æœå†™å…¥åˆ°é¢å¤–åˆ—ä¸­ã€‚



## è®¾ç½®åˆ—å¸ƒå±€

åˆ—å¸ƒå±€ï¼šæ¯ä¸€åˆ—çš„ç©¶ç«Ÿæ˜¾ç¤ºå“ªäº›å±æ€§ã€‚

**æ·»åŠ åˆ—çš„æ–¹æ³•**

![Column-AddColumn-1](_resources/Column-AddColumn-1.png)



**åˆ—å±æ€§çš„ç±»å‹**

ä¸€ä¸ªåˆ—ä¸­å¯ä»¥è½½å…¥ä¸‰ç§ç±»å‹çš„å±æ€§ï¼šProperty, Special Property, Custom Column

![Column-AddColumn-2](_resources/Column-AddColumn-2.png)

å¯¹äºCustom Columnå¯ä»¥é…ç½®å®ƒçš„è½½å…¥å±æ€§è¿˜å¤šå‡ºäº†ä¸‰ç§ï¼šScript, Template, Mixed:

![Column-Type-1](_resources/Column-Type-1.png)

### å®šåˆ¶å±æ€§åˆ—

**[æ¡ˆä¾‹]æ·»åŠ æ–‡ä»¶å±æ€§é¡¹åˆ—**

![CustomizeList-Property-Tags-1](_resources/CustomizeList-Property-Tags-1.png)

![CustomizeList-Property-Tags-2](_resources/CustomizeList-Property-Tags-2.png)

![CustomizeList-Property-Tags-3](_resources/CustomizeList-Property-Tags-3.png)



### å®šåˆ¶è‡ªå®šä¹‰åˆ—

**[æ¡ˆä¾‹1]Image size in inches**

1. åœ°å€æ è¾“å…¥`::snippet`

2. åœ¨æç¤ºæ¡†ä¸­è¾“å…¥

   ```
   Snip: CustomColumn 1
     XYplorer 18.90.0000, 22.03.2018 12:28:38
   Action
     ConfigureColumn
   Caption
     Size (inches)
   Type
     3
   Definition
         $dpi = get("Screen", "dpi");
         $hSize = property('System.Image.HorizontalSize', <cc_item>);
         $vSize = property('System.Image.VerticalSize', <cc_item>);
         if (!$hSize || !$vSize) { return "<unknown size>"; }
         return round(($hSize / $dpi), 2) . " x " . round(($vSize / $dpi), 2);
   Format
     1
   Trigger
     1
   Item Type
     0
   Item Filter
     {:Image}
   
   ```

3. è¿™æ ·å°±æ·»åŠ äº†åä¸ºSize (inches)çš„è‡ªå®šä¹‰åˆ—äº†ï¼Œæ•ˆæœå›¾å¦‚ä¸‹

   ![CustomColumn-Customize-1](_resources/CustomColumn-Customize-1.png)

   ![CustomColumn-Customize-2](_resources/CustomColumn-Customize-2.png)

4. æ·»åŠ è‡ªå®šä¹‰åˆ—

   ![CustomColumn-AddColumn-1](_resources/CustomColumn-AddColumn-1.png)

   

   ![CustomColumn-AddColumn-3](_resources/CustomColumn-AddColumn-3.png)

   ![CustomColumn-AddColumn-4](_resources/CustomColumn-AddColumn-4.png)

   è¿™æ ·å°±æ·»åŠ å¥½äº†ã€‚

   ![CustomColumn-AddColumn-5](_resources/CustomColumn-AddColumn-5.png)



**[æ¡ˆä¾‹2]Resolution**

1. åœ°å€æ è¾“å…¥`::snippet`ï¼Œåœ¨æç¤ºæ¡†ä¸­è¾“å…¥å¦‚ä¸‹å†…å®¹

   ```
   Snip: CustomColumn 1
     XYplorer 18.90.0000, 22.03.2018 12:28:38
   Action
     ConfigureColumn
   Caption
     DPI
   Type
     3
   Definition
         $hSize = property('System.Image.HorizontalSize', <cc_item>);
         $vSize = property('System.Image.VerticalSize', <cc_item>);
         if (!$hSize || !$vSize) { return "<unknown size>"; }
         return $hSize." x " .$vSize;
   Format
     1
   Trigger
     1
   Item Type
     0
   Item Filter
     {:Image}
   
   ```

2. æŒ‰ç…§[Image size in inches]çš„æ–¹æ³•æ·»åŠ DPIåˆ—åˆ°åˆ—å¸ƒå±€ä¸­ã€‚

   ![CustomColumn-AddColumn-DPI](_resources/CustomColumn-AddColumn-DPI.png)



ğŸ“˜[Overview of custom column snippets / scripts - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?f=7&t=18653)

## æ–‡ä»¶æ•°é‡è¿‡å¤šæ—¶åˆ—åŠ è½½å¡é¡¿çš„è§£å†³æ–¹æ³•

æ–‡ä»¶æ•°é‡è¿‡å¤šä¼šå¡ï¼Œè¿™æ˜¯XYåº”è¯¥èƒŒçš„é”…å—ï¼Œæˆ‘è®¤ä¸ºè´£ä»»åº”è¯¥å¯¹åŠåˆ†ï¼Œå› ä¸ºè¿™äº›æ–‡ä»¶è¦ä½¿ç”¨Shell Propertiesè¯»å–å±æ€§ï¼Œç„¶åå°†è¿™äº›å±æ€§æ˜¾ç¤ºåˆ°Custom Columnä¸­ï¼Œé‚£ä¹ˆä»è½¯ä»¶å±‚æ¬¡è€ƒè™‘ï¼Œé€Ÿåº¦å–å†³äºè¯»å–å±æ€§çš„é€Ÿåº¦(Windowsä¾§)å’Œè½½å…¥åˆ°Custom Column(XYä¾§)çš„é€Ÿåº¦ï¼ŒXYä¾§å†æ·±å…¥ç‚¹è®²ï¼Œä¹Ÿè¦è€ƒè™‘åˆ°ä½¿ç”¨Scriptä¸­æ¶‰åŠéå†çš„æƒ…å†µã€‚å¯èƒ½ä¼šæœ‰äººè¯´ï¼Œå¹²å—ä¸ç”¨åˆ°ç¼“å­˜æŠ€æœ¯ï¼Œå…¶å®æˆ‘ä¹Ÿåœ¨æƒ³ä¸ºä»€ä¹ˆä¸ç”¨åˆ°ç¼“å­˜æŠ€æœ¯å‘¢ï¼Œå¹¶ä¸æ˜¯XYæ²¡æœ‰ä½¿ç”¨åˆ°è¿™ä¸€æŠ€æœ¯ï¼Œåªä¸è¿‡XYæ²¡æœ‰è¿ç”¨ç¼“å­˜æŠ€æœ¯åˆ°éƒ¨åˆ†Custom Columnä¸Šã€‚å› æ­¤ï¼Œè®¸å¤šè‡ªå®šä¹‰åˆ—ä¼šå¡çš„åŸå› å°±åœ¨è¿™é‡Œï¼Œä¹Ÿå°±æ˜¯ä½ æ‰“å¼€æ–‡ä»¶å¤¹ï¼ŒXYå°±å¼€å§‹æ‰«æå¹¶è½½å…¥å±æ€§åˆ°æ–‡ä»¶åˆ—è¿™ä¸ªè¿‡ç¨‹å¡ï¼Œè¿™å–å†³ä½ çš„æ–‡ä»¶æ•°é‡ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Extra Tagè¿›è¡Œæ¨¡æ‹Ÿç¼“å­˜ï¼ˆåœ¨ä¸‹é¢ä¼šè®²åˆ°ï¼‰ï¼Œä¹Ÿæˆ–è€…æ”¹å˜è½½å…¥è‡ªå®šä¹‰åˆ—çš„è§¦å‘æ–¹å¼ã€‚



**æ–¹æ³•1.æ”¹å˜è½½å…¥Custom Columnçš„è§¦å‘æ–¹å¼**

-è¿›å…¥Custom Columné…ç½®ç•Œé¢ã€‚æœ‰ä¸¤ç§æ–¹æ³•

æ–¹æ³•ä¸€ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ

![CustomColumn-Edit-1](_resources/CustomColumn-Edit-1.png)

æ–¹æ³•äºŒã€‚F9å‘¼å‡ºè®¾ç½®ç•Œé¢ï¼ŒæŒ‰å¦‚ä¸‹å›¾æ‰€ç¤ºè¿›è¡Œæ“ä½œï¼Œ

![CustomColumn-Edit-Trigger-1](_resources/CustomColumn-Edit-Trigger-1.png)

ä¸»è¦æ”¹å˜çš„æ˜¯Triggerå‚æ•°ï¼Œè¿™é‡Œæœ‰ä¸‰ä¸ªï¼Œå„æœ‰ä¼˜ç¼ºç‚¹ï¼Œå…¶ä¸­Listå’ŒClickéƒ½å¯ä»¥é¿å…å¤§é‡æ–‡ä»¶æ—¶çš„å¡é¡¿ã€‚

å…³äºClickçš„è¿ç”¨åœºæ™¯å°±æ˜¯ï¼š

æ·»åŠ ä¸€ä¸ªå…³é”®å­—åŒ…å«"MD5"çš„Custom Columnï¼Œè€Œä¸æ˜¯Columnï¼Œç„¶åé…ç½®å…¶è§¦å‘æ–¹å¼ä¸ºClickï¼Œç„¶åå†éœ€è¦ä½¿ç”¨çš„æ—¶å€™ç‚¹å‡»MD5å¯¹åº”çš„Custom Columnï¼Œè¯»å–MD5

![CustomColumn-Add-MD5-1](_resources/CustomColumn-Add-MD5-1.png)

Triggerå‚æ•°ä»‹ç»

åœ°å€æ è¾“å…¥ï¼š

```c
rtfm "idh_customcolumns.htm";		//è¿›å…¥åï¼Œæ‰¾åˆ°Triggeré»‘ä½“å­—æ ‡é¢˜éƒ¨åˆ†
```

å¯æ‰¾åˆ°å¯¹åº”çš„è‹±æ–‡è§£é‡Šï¼Œåœ¨è¿™é‡Œç»™å‡ºï¼š

> Trigger
>
> Here you can select at which point the  script or process that generates the cell data is actually triggered. You have  three choices:
>
> - **Browse** [Default]: Column is triggered when the list is filled with  folder contents or search results.
> - **List**:  Column is triggered when the items are listed. Only the currently visible items  are processed. This option will be much faster than "Browse" on long lists, but  the scrolling will be not as smooth.
> - **Click**: Column is triggered when the symbol that is shown as a  placeholder is clicked (actually you can click anywhere in the cell). Maximum  speed, also when scrolling. All data are only shown on demand.
>
> Notes:
>
> - When you right-click a column header and select Refresh  Column then the whole column data will be generated/refreshed.
> - Columns of type "Mixed" inherit the trigger per-cell from  the chosen sub-column.
> - When Custom Columns of type Script are triggered by Click  and the script has no "return" command then the click symbol remains in the list  and can be clicked again and again.



**æ–¹æ³•2.åˆ©ç”¨Extra Columnæ‰‹åŠ¨æ¨¡æ‹Ÿç¼“å­˜**

ä¸‹é¢æ¨¡æ‹Ÿå¯¹æ‰€æœ‰æ–‡ä»¶åˆ—è¡¨åŠ è½½DPIå±æ€§ï¼Œæ•ˆæœå¦‚ä¸‹ï¼Œ

![CustomColumn-UseExtraColumn-1](_resources/CustomColumn-UseExtraColumn-1.gif)

è¿™æ ·åšçš„å¥½å¤„æ˜¯æ‰€æœ‰æ–‡ä»¶åˆ—éœ€è¦DPIçš„å±æ€§éƒ½å¯¼å…¥åˆ°Extra Column1ä¸­äº†ï¼Œè¿™æ ·æŒä¹…åŒ–çš„æ•°æ®å°±é¿å…äº†å¤§é‡ä½¿ç”¨Shell PropertiesåŠ è½½ã€‚

è¯¥è„šæœ¬çš„åŠŸèƒ½æ˜¯æ‰«æå½“å‰æ–‡ä»¶å¤¹çš„å›¾ç‰‡ï¼Œè‹¥æœ‰å­æ–‡ä»¶æ˜¯ä¸ä¼šå»éå†çš„ã€‚è¯¥è„šæœ¬ä¸€æ—¦å¼€å§‹ï¼Œæ— æ³•ç»“æŸï¼Œä¹Ÿå°±æ˜¯ä½ åªèƒ½ç­‰å¾…è„šæœ¬æ‰§è¡Œç»“æŸï¼Œå¦åˆ™é€‰æ‹©å¼ºåˆ¶ç»“æŸè¿›ç¨‹ã€‚è¿™ä¸æ˜¯æ„å‘³ç€è„šæœ¬ä½¿XYå¡ä½äº†ï¼Œè€Œæ˜¯å¤§é‡IOè¯»å†™ï¼Œèƒ½å¤„ç†å¤šå¿«ä¸ç£ç›˜æ€§èƒ½æœ‰å…³ï¼Œè‹¥æ‰«æçš„æ–‡ä»¶å¤„äºç£ç›˜åé“æˆ–æ‰‡åŒºä¸Šï¼Œä¼šé€ æˆå¡æ­»ã€‚

å¦‚æœä½ ä¸€ä¸ªæ–‡ä»¶å¤¹æœ‰ä¸Šä¸‡ä¸ªå›¾ç‰‡ï¼Œè€å®è¯´æˆ‘ä¹Ÿä¸çŸ¥é“æ‰§è¡Œå¾—æœ‰å¤šæ…¢ã€‚

```
	sel 1;
	while (<curitem> != "") {
		// msg <curitem>;
		$dims = property("#image.dimensions", <cc_item>);
		$width = gettoken($dims, 1, " x ");
		$height = gettoken($dims, 2, " x ");
		tag $width." x ".$height, <curitem>, "ex1";
		sel + 1;
	}
```

è„šæœ¬å·²ç»è´´å‡ºã€‚

æ·»åŠ åˆ°ç›®å½•æ çš„æ–¹æ³•æ˜¯æ·»åŠ ä¸€ä¸ªé¡¹ç›®<kbd>Insert</kbd>åˆ°ç›®å½•ï¼Œå…¶ä¸­Locationå¡«å†™å¦‚ä¸‹å†…å®¹

```
::load <xyscripts>."\åç§°.xys";	//è„šæœ¬æ–‡ä»¶è¯·æ”¾åœ¨XY/Data/Scriptsæ–‡ä»¶å¤¹
```

ä½¿ç”¨è¿™ä¸ªè„šæœ¬çš„ç¼ºç‚¹å°±æ˜¯ä¼šå¢åŠ tag.datï¼Œéšç€tag.datå¤§å°è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“ä¼šä¸ä¼šè®©XYè¿è¡Œæ—¶å‡ºç°ä»€ä¹ˆè«åå…¶å¦™çš„BUGã€‚éšè—éœ€è¦ç»´æŠ¤tag.datæ•°æ®æ–‡ä»¶ï¼Œå…³äºæ¸…ç†æ•°æ®æ–‡ä»¶å¯å‚è€ƒï¼š

[Folder size caching - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?f=5&t=11375)

ä½¿ç”¨è¿‡ç¨‹å¯èƒ½å­˜åœ¨çš„ç–‘é—®ï¼š[100MB limit in tag.dat? - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?t=19289)




Extra Columnçš„å‘½åé€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°ï¼Œ

![CustomColumn-UseExtraColumn-2](_resources/CustomColumn-UseExtraColumn-2.png)



ğŸ“˜[video folder with special custom columns opens slow - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?t=18715)

ğŸ“˜[Slow Loading of Large Folders - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?t=19296)

ğŸ“˜[Folders with a lot of files charge very slow - XYplorer Beta Club](https://www.xyplorer.com/xyfc/viewtopic.php?f=3&t=19090&p=160050#p160050)

åœ°å€æ è¾“å…¥å¯é˜…è¯»æ¶‰åŠä¸»é¢˜çš„å‚è€ƒï¼š

```c
rtfm "idh_customcolumns.htm#idh_ccscriptedcolumns";		// Scripted Columns
rtfm "idh_scripting_comref.htm#idh_sc_property";		// property()
rtfm "idh_variables.htm";		// XYplorer Native Variables
http://msdn.microsoft.com/en-us/library/windows/desktop/dd561977%28v=vs.85%29.aspx		// the locale-independent Windows canonical properties
```



## ä¿å­˜å’ŒåŠ è½½åˆ—å¸ƒå±€

ä¸ºäº†å®šåˆ¶è‡ªå®šä¹‰åˆ—ç”¨äºæ˜¾ç¤ºä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œæ¯”å¦‚è§†é¢‘æ–‡ä»¶çš„è‡ªå®šä¹‰åˆ—æœ‰æ’­æ”¾æ—¶é—´ï¼Œåˆ†è¾¨ç‡ï¼ŒCodecsç­‰ç­‰ï¼›éŸ³é¢‘æ–‡ä»¶éœ€è¦çš„è‡ªå®šä¹‰åˆ—æœ‰Codecsï¼Œæ’­æ”¾æ—¶é—´ï¼ŒSample Rateç­‰ç­‰ï¼›å›¾ç‰‡æ–‡ä»¶éœ€è¦è‡ªå®šä¹‰åˆ—æœ‰DPIï¼ŒAlbumï¼Œç…§ç›¸æœºç±»å‹ï¼Œæ‹æ‘„æ—¶é—´ç­‰ç­‰ã€‚ç”±æ­¤å®šåˆ¶è‡ªå®šä¹‰åˆ—æ˜¾å¾—å¿…è¦ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜è‡ªå®šä¹‰åˆ—ï¼Œåœ¨éœ€è¦çš„æ—¶å€™è¿›è¡ŒåŠ è½½ã€‚

-ä¿å­˜Column Layout

![ColumnLayout-Save-1](_resources/ColumnLayout-Save-1.png)

![ColumnLayout-Save-2](_resources/ColumnLayout-Save-2.png)

Column Layoutçš„æ–‡ä»¶å‘½ååº”è¯¥ç¬¦åˆä»¥ä¸‹çš„æ ¼å¼ï¼Œæ‰ä¼šæ¸…æ™°ä¾¿äºç¡®å®šåˆ—çš„é¡ºåºï¼š

```
ç¬¬1åˆ—å-ç¬¬2åˆ—å-...-ç¬¬Nåˆ—å.txt
```



-åŠ è½½Column Layout

åœ¨è‡ªå®šä¹‰åˆ—ç©ºç™½å¤„å³é”®->Load Column Layout...->é€‰æ‹©æƒ³è¦çš„åˆ—å¸ƒå±€ã€‚

## åˆ—å¸ƒå±€åº”ç”¨åˆ°ç‰¹å®šæ–‡ä»¶å¤¹

å‡è®¾ä½ æœ‰StudyLib, PictureLib, Pothole, VideoLibè¿™å‡ ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«è£…ç€åŒç±»çš„æ–‡ä»¶ã€‚å¦‚æœä½ æƒ³è®©æ¯ä¸ªæ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶éƒ½æŒ‰éœ€æ˜¾ç¤ºä¸åŒçš„è‡ªå®šä¹‰åˆ—ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦åˆ†åˆ«å¯¹StudyLib, PictureLib, Pothole, VideoLibçš„æ–‡ä»¶å¤¹è§†å›¾è®¾ç½®ä¸­å‹¾é€‰`Cloumn layout`ï¼Œå¹¶ä¸”å‹¾é€‰`Include subfolders`ï¼š

![CustomColumn-FolderViewSettings](_resources/CustomColumn-FolderViewSettings.png)

`Folder to apply the settings to`çš„åŒ¹é…è§„åˆ™ï¼š

```c
F:\StudyLib	//åŒ¹é…åœ¨Fç›˜çš„StudyLibæ–‡ä»¶å¤¹
*\Images*	//åŒ¹é…æ‰€æœ‰åä¸ºImages(ä¸åŒºåˆ†å¤§å°å†™)çš„æ–‡ä»¶å¤¹
*\Images*|*\Pics*	//åŒ¹é…æ‰€æœ‰åä¸ºImages(ä¸åŒºåˆ†å¤§å°å†™)å’ŒPics(ä¸åŒºåˆ†å¤§å°å†™)çš„æ–‡ä»¶å¤¹
```

`Match case`: å‹¾é€‰åï¼ŒåŒ¹é…æ—¶ä¼šåŒºåˆ†æ–‡ä»¶å¤§å°å†™ï¼Œæ¯”å¦‚\*\\Images\*ä¸ä¼šåŒ¹é…åä¸ºimagesçš„æ–‡ä»¶å¤¹ã€‚

è¿™ä¸ªåœ°æ–¹æˆ‘æ²¡æ³•è®²å°ç»†ï¼Œç­‰æˆ‘ç”¨åˆ°å°±ä¼šè¡¥ä¸Šä¸€ä¸ªå…·ä½“æ¡ˆä¾‹ï¼Œå¦‚æœè¦è®²è§£æˆ‘ä¼šæ–°èµ·ä¸€ä¸ªä¸€çº§æ ‡é¢˜æ¥è®²"æ–‡ä»¶å¤¹è§†å›¾è®¾ç½®"ã€‚



# æ ‘é¢æ¿çš„ä½¿ç”¨

æ ‘çš„é…ç½®ä¸»è¦åœ¨`View`ã€`Tools->Customize Tree`ã€`Configuration(F9)->Tree and List`ï¼Œå°‘éƒ¨åˆ†å¯ä»¥é€šè¿‡é”®å…¥å…³é”®å­—"Tree"åˆ°`Configuration(F9)->å·¦ä¸‹è§’Jump to Setting`è¿›è¡Œå¯»æ‰¾ã€

èœå•æ `Windows->Show Tree(Shift + F8)`ï¼Œæ‰“å¼€Treeè®°å½•åŠŸèƒ½ã€‚

`View->Mini Tree`ï¼šåªæ˜¾ç¤ºé€‰é¡¹å¡(Tab)çš„è·¯å¾„çš„æ ‘ï¼Œç”±äºä¸éœ€è¦æ˜¾ç¤ºæ— å…³ç›®å½•çš„æ ‘ï¼Œæ‰€ä»¥é€Ÿåº¦æ›´å¿«ã€‚

ç”±äºTreeä¼šè®°å½•æ–‡ä»¶æµè§ˆå†å²ï¼Œåœ¨é€€å‡ºXYplorerå‰ï¼Œ`View->Reset Tree(Ctrl + Shift + F4)`ï¼Œå¦‚æœè·¯å¾„å†å²è¿‡å¤šï¼Œå½±å“åŠ è½½é€Ÿåº¦ã€‚

åœ¨Treeå¼€å¯çš„æƒ…å†µä¸‹ï¼Œæ¯ä¸€æ¬¡æµè§ˆç›®å½•ï¼Œä¾§è¾¹çš„Treeéƒ½ä¼šè¿½è¸ªè®°å½•ï¼Œæ‰€ä»¥ä½ å¯ä»¥å¾ˆå®¹æ˜“çœ‹åˆ°å½“å‰ç›®å½•å’Œå†å²ç›®å½•çš„å±‚æ¬¡ç»“æ„ã€‚

`Tools->Customize Tree->Tree Path Tracking`ï¼šå¼€å¯æ ‘è¿½è¸ªæ ‡è®°

![TreeUse-1](_resources/TreeUse-1.png)

`View->Lock Tree`ï¼šå¼€å¯åï¼Œè®°ä½ï¼ˆå†»ç»“ä¸ºï¼‰ä¸Šä¸€æ¬¡æ ‘ç»“æ„çš„çŠ¶æ€ï¼Œæ¥ä¸‹æ¥æ— è®ºæ€æ ·æµè§ˆç›®å½•ï¼Œæ ‘çš„è¿½è¸ªè®°å½•éƒ½çœ‹ä¸åˆ°ã€‚å¼€å¯æœŸé—´ï¼Œåº”è¯¥æ˜¯ä¸ä¼šæœ‰ç›®å½•è¿½è¸ªè®°å½•çš„ã€‚å½“å…³é—­åï¼Œæ¢å¤æ ‘çš„è¿½è¸ªè®°å½•åŠŸèƒ½ï¼Œå¹¶æ›´æ–°ä¸ºå½“å‰ç›®å½•çš„æ ‘ç»“æ„ã€‚ä½¿ç”¨å»ºè®®ï¼šéœ€è¦æ ‘åŠŸèƒ½ï¼ŒXYplorerè¿è¡Œå¡çš„æƒ…å†µä¸‹å¯é”å®šã€‚

æˆ‘çš„ä½¿ç”¨æ–¹æ³•ï¼šå…³é—­Mini Treeï¼ŒReset Treeï¼ŒLock Treeã€‚æŠŠTreeçš„ä¾§è¾¹æ ç©ºé—´å‹ç¼©ï¼Œåªä¿ç•™å¾ˆå°çš„åœ°æ–¹ï¼Œå¦‚å›¾

![TreeUse-1](_resources/TreeUse-2.png)

ä¹‹æ‰€ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸ºæˆ‘éœ€è¦å¿«é€Ÿæµè§ˆC/D/E/Fï¼Œå¯¹æ˜¾ç¤ºæ ‘ç»“æ„çš„ç›®å½•éœ€æ±‚ä¸æ˜¯å¾ˆå¤§ï¼Œå¹¶ä¸”åœ¨Treeä¾§è¾¹æ **å³é”®**å¯ä»¥å¼¹å‡º**æ”¶è—å¤¹åˆ—è¡¨**ã€‚

å¦‚æœä½ éœ€è¦ä½¿ç”¨æ ‘çš„åŠŸèƒ½ï¼Œè¯·ä¸€å®šè¦æŠŠXYplorerç•Œé¢å·¦å³ä¸¤ä¾§æ‹‰é•¿ï¼Œå¦‚æœä¸æ‹‰é•¿ï¼Œä½¿ç”¨èµ·æ¥å¾ˆæ²¡æœ‰ä½“éªŒã€‚ä¸¤ä¾§æ‹‰é•¿è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç†ç”±ï¼šä½†ä½ çš„æ–‡ä»¶å¤¹è§†å›¾æ˜¯â€œè¯¦æƒ…è§†å›¾â€æ—¶ï¼Œæ¯ä¸€ä¸ªæ–‡ä»¶çš„æè¿°åˆ—ï¼šæ–‡ä»¶åã€ä¿®æ”¹æ—¶é—´ã€åˆ›å»ºæ—¶é—´ã€åç¼€åã€æ–‡ä»¶å¤¹å¤§å°ç­‰ï¼Œæƒ³è¦æŠŠè¿™äº›åˆ—çš„ä¿¡æ¯å…¨ï¼Œé‚£ä¹ˆä½ å°±å¿…é¡»æ‹‰é•¿ã€‚

åœ¨å¼€å¯â€œMini Treeâ€çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥è¿›å…¥è®¾ç½® -> General -> Control & More -> Miscellaneous -> `Allow zombies in the Mini Tree`å¯ä»¥ä½¿å¾—å½“å‰æ–‡ä»¶å¤¹æ˜¾ç¤ºåœ¨æ ‘é¢æ¿ï¼Œè€ŒåŒçº§æ–‡ä»¶å¤¹ä¸ä¼šæ˜¾ç¤ºã€‚

# å·¥å…·æ çš„ä½¿ç”¨

**å·¥å…·æ çš„æ‘†æ”¾å’Œä½¿ç”¨**

ä¸€ä¸ªåˆç†çš„å·¥å…·æ æŒ‰é’®æ‘†æ”¾ï¼Œå¯ä»¥æé«˜ä½¿ç”¨æ•ˆç‡ã€‚è¿™æ˜¯æˆ‘çš„å·¥å…·æ æŒ‰é’®æ‘†æ”¾(2020/11/10)ï¼š

![ToolbarPArrangement-1](_resources/ToolbarPArrangement-1.png)

æˆ‘çš„ç”µè„‘ | å‰ã€åé€€ã€ä¸Šä¸€çº§ã€æ’¤é”€ç­‰ | æ”¶è—ã€æ·»åŠ Tags | æ–‡ä»¶å±æ€§ã€æ‰“å¼€æ–¹å¼ã€æ˜¯å¦æ˜¾ç¤ºç³»ç»Ÿæ–‡ä»¶ï¼Œéšè—æ–‡ä»¶ |  Visualè¿‡æ»¤ | Pane | Colorè¿‡æ»¤å™¨ | è®¾ç½® å¤œé—´æ¨¡å¼ | ViewåŠŸèƒ½ | ç”¨æˆ·æŒ‰é’®

## <span id="further_use_of_button">æŒ‰é’®çš„é«˜çº§ç”¨æ³•</span>

### <span id="explorer_button">[æ¡ˆä¾‹1]ä½¿ç”¨Windowsæ–‡ä»¶ç®¡ç†å™¨æ‰“å¼€XYplorerå½“å‰è·¯å¾„</span>

-ä½¿ç”¨æ•ˆæœå¦‚ä¸‹ï¼Œ

![](_resources/Explorer-1.png)-å…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼Œ

1.æå–å›¾æ ‡ã€‚æå–å·¥å…·[IcoFX3(ä¸‹è½½åœ°å€è‹¥å¤±æ•ˆï¼Œè‡ªè¡Œä¸‹è½½)](https://ghpym.lanzous.com/b00zelckd)[å¯é€‰]

![IcoFx-1](_resources/IcoFx-1.png)

![IcoFx-1](_resources/IcoFx-2.png)

![IcoFx-1](_resources/IcoFx-3.png)

2.æ·»åŠ æŒ‰é’®

![AddButton-1](_resources/AddButton-1.png)

![AddButton-2](_resources/AddButton-2.png)

![AddButton-3](_resources/AddButton-3.png)

å†…å®¹ä¿¡æ¯å¦‚ä¸‹

``` 
Explorer
<xyicons>\Explorer.ico
run "C:\Windows\explorer.exe" <curpath>
```

è¿™ä¸ªè„šæœ¬ä¸å®Œå–„ï¼Œä»…é™æ‰“å¼€å½“å‰ç›®å½•ã€‚éœ€è¦åŠŸèƒ½æ›´å…¨çš„Explorerè„šæœ¬ï¼Œå¯ä»¥ä½¿ç”¨[XYplorer-ç”¨æˆ·è‡ªå®šä¹‰å‘½ä»¤ç¯‡(UDC)](./XYplorer-ç”¨æˆ·è‡ªå®šä¹‰å‘½ä»¤ç¯‡(UDC).md)ä¸­çš„[è®¾ç½®å¿«æ·é”®è°ƒç”¨Explorer]éƒ¨åˆ†çš„è„šæœ¬ã€‚

`<xyicons>`ä»‹ç»è¯·å‚è€ƒ[XYplorer-è„šæœ¬ç¯‡(Scripting)](./XYplorer-è„šæœ¬ç¯‡(Scripting).md)ã€‚

### [æ¡ˆä¾‹2]CMDé›†æˆåˆ°æŒ‰é’®

XYå®˜ç½‘å·²ç»æŠŠ**Cmdçš„æŒ‰é’®é›†æˆåˆ°å·¥å…·æ äº†**ï¼Œå¹¶ä¸”æä¾›äº†çƒ­é”®<kbd>Ctrl + Alt + P</kbd>ã€‚

ä½ ç°åœ¨å¯ä»¥åœ¨è‡ªå®šä¹‰å·¥å…·æ ä¸­çš„åˆ—è¡¨ä¸­æ‰¾åˆ°å®ƒï¼Œ

![Cmd-2](_resources/Cmd-2.png)

ä¸è¿‡ä¸‹é¢æˆ‘è¿˜æ˜¯ç»™å‡ºç”¨æˆ·è‡ªå®šä¹‰CmdæŒ‰é’®çš„æ–¹æ³•ã€‚

![Cmd-1](_resources/Cmd-1.png)

æŒ‰é’®ä¿¡æ¯å¦‚ä¸‹ï¼Œ

```
Cmd as Admin
<xyicons>\Cmd.ico

$comspec = ("%osbitness%" == 64) ? "%windir%\System32\cmd.exe" : "%windir%\SysWOW64\cmd.exe";
    $cscript = ("%osbitness%" == 64) ? "%windir%\System32\cscript.exe" : "%windir%\SysWOW64\cscript.exe";

    $vbsFile = "%TEMP%\~OpenElevatedCMD.vbs";

    $vbsContent = <<<>>>
        Set UAC = CreateObject("Shell.Application")
        UAC.ShellExecute "$comspec", "/k pushd ""<curpath>""", "", "runas", 1
>>>;

    writefile($vbsFile, trim($vbsContent));

    if (get("trigger") == "1") { // Left click -> Admin
        run """$cscript"" ""$vbsFile"" //nologo", , 0, 0;
    } elseif (get("trigger") == "2") { // Right click -> No admin
        run """$comspec"" /k pushd ""<curpath>""";
    }
```

æŒ‰é’®çš„æ·»åŠ æ–¹æ³•åœ¨â€œæŒ‰é’®çš„é«˜çº§ç”¨æ³•â€[[?](#further_use_of_button)]éƒ¨åˆ†æœ‰è®²åˆ°ã€‚

XYploeræŒ‰é’®é›†æˆçš„CMDæœ‰æ—¶æ— æ³•è¯†åˆ«ä¸€äº›ç¯å¢ƒå˜é‡ã€‚å¦‚æœä½ ä¸ä¹ æƒ¯XYå³é”®èœå•ï¼Œå¯æ›¿æ¢ä¸ºWindowså³é”®èœå•ï¼Œå¯å‚è€ƒhttps://zhuanlan.zhihu.com/p/70331585